when:
  - event: push
    branch: main

steps:
  install:
    image: node
    commands:
      - yarn
  build-site:
    image: node
    commands:
      - yarn build
  build-image:
    image: woodpeckerci/plugin-docker-buildx
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    settings:
      dockerfile: .woodpecker/Dockerfile
      repo: ilovetrees-ui
      tags: latest
      dry-run: true
